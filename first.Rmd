---
title: "STAT253"
author: "Federico Chung"
date: "10/3/2019"
output: html_document
---

```{r setup, include=FALSE}
library(ggplot2)  # for plots
library(dplyr)    # for wrangling
library(caret)    # for machine learning algorithms
```


```{r}
data<- read.csv("airbnb_joined.csv")

```

```{r}
set.seed(256)

data<-data%>%
  sample_n(5000)

data

data<- data %>% filter(price<1000)
View(data)
```


```{r}
names(data)
View(data)
```


```{r}
sum(complete.cases(data_small))
colSums(is.na(data_small))
```

```{r}
data_small<- data%>% select(-c(X,id, is_location_exact, calendar_updated, latitude, longitude, square_feet))
data_small$host_response_time[data_small$host_response_time == "N/A"] <- " "

```

```{r}
data_small$host_response_rate[data_small$host_response_time == "N/A"] <- " "
```


```{r}
impute_info <- data_small %>%
  preProcess(method = "knnImpute")
data_complete <- predict(impute_info, newdata = data_small) 
```

```{r}
colSums(is.na(data_complete))
sum(complete.cases(data_complete))
```

##Part 2: Analyze
##Narrowing down predictors:LASSO
    ```{r}
    # Define a range of lambda tuning parameters to try
    lambda_grid <- 10^seq(-3, 0.5, length = 100)

    # Set the seed
    set.seed(253)

    # Perform LASSO
    lasso_model_data <- train(
      price~.,
      data = data_complete,
      method = "glmnet",
      trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
      tuneGrid = data.frame(alpha=1, lambda=lambda_grid),
      metric = "MAE",
      na.action = na.omit
    )
    ```







